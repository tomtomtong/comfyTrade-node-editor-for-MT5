<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradingView Integration Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .symbol-input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 5px;
            width: 200px;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            background: #f8f9fa;
            border-left: 4px solid #007bff;
        }
    </style>
</head>
<body>
    <h1>TradingView Integration Test</h1>
    
    <div class="test-container">
        <h2>Symbol Mapping Test</h2>
        <p>Test the symbol mapping functionality without opening actual TradingView links.</p>
        
        <input type="text" id="testSymbol" class="symbol-input" placeholder="Enter symbol (e.g., EURUSD)" value="EURUSD">
        <button class="test-button" onclick="testSymbolMapping()">Test Mapping</button>
        
        <div id="mappingResult" class="result" style="display: none;"></div>
    </div>
    
    <div class="test-container">
        <h2>Quick Symbol Tests</h2>
        <p>Test common trading symbols:</p>
        
        <button class="test-button" onclick="testSymbol('EURUSD')">EURUSD</button>
        <button class="test-button" onclick="testSymbol('XAUUSD')">XAUUSD (Gold)</button>
        <button class="test-button" onclick="testSymbol('BTCUSD')">BTCUSD</button>
        <button class="test-button" onclick="testSymbol('GBPJPY')">GBPJPY</button>
        <button class="test-button" onclick="testSymbol('US30')">US30</button>
        
        <div id="quickTestResult" class="result" style="display: none;"></div>
    </div>
    
    <div class="test-container">
        <h2>TradingView URL Test</h2>
        <p>Generate and optionally open TradingView URLs:</p>
        
        <input type="text" id="urlTestSymbol" class="symbol-input" placeholder="Enter symbol" value="EURUSD">
        <button class="test-button" onclick="generateURL()">Generate URL</button>
        <button class="test-button" onclick="openTradingView()">Open TradingView</button>
        
        <div id="urlResult" class="result" style="display: none;"></div>
    </div>

    <script>
        // Symbol mapping logic (copied from the main application)
        function mapSymbolToTradingView(symbol) {
            if (!symbol) return '';
            
            const symbolMappings = {
                'EURUSD': 'FX:EURUSD',
                'GBPUSD': 'FX:GBPUSD',
                'USDJPY': 'FX:USDJPY',
                'USDCHF': 'FX:USDCHF',
                'AUDUSD': 'FX:AUDUSD',
                'USDCAD': 'FX:USDCAD',
                'NZDUSD': 'FX:NZDUSD',
                'EURJPY': 'FX:EURJPY',
                'GBPJPY': 'FX:GBPJPY',
                'EURGBP': 'FX:EURGBP',
                'XAUUSD': 'TVC:GOLD',
                'XAGUSD': 'TVC:SILVER',
                'BTCUSD': 'BITSTAMP:BTCUSD',
                'ETHUSD': 'BITSTAMP:ETHUSD'
            };
            
            // Use mapping if available, otherwise use symbol as-is with FX prefix for forex pairs
            if (symbolMappings[symbol.toUpperCase()]) {
                return symbolMappings[symbol.toUpperCase()];
            } else if (symbol.length === 6 && /^[A-Z]{6}$/.test(symbol)) {
                // Likely a forex pair, add FX prefix
                return `FX:${symbol.toUpperCase()}`;
            } else {
                return symbol.toUpperCase();
            }
        }
        
        function testSymbolMapping() {
            const symbol = document.getElementById('testSymbol').value;
            const mapped = mapSymbolToTradingView(symbol);
            const url = `https://www.tradingview.com/chart/?symbol=${mapped}`;
            
            const result = document.getElementById('mappingResult');
            result.innerHTML = `
                <strong>Input Symbol:</strong> ${symbol}<br>
                <strong>Mapped Symbol:</strong> ${mapped}<br>
                <strong>TradingView URL:</strong> <a href="${url}" target="_blank">${url}</a>
            `;
            result.style.display = 'block';
        }
        
        function testSymbol(symbol) {
            const mapped = mapSymbolToTradingView(symbol);
            const url = `https://www.tradingview.com/chart/?symbol=${mapped}`;
            
            const result = document.getElementById('quickTestResult');
            result.innerHTML = `
                <strong>${symbol}</strong> â†’ <strong>${mapped}</strong><br>
                <a href="${url}" target="_blank">Open in TradingView</a>
            `;
            result.style.display = 'block';
        }
        
        function generateURL() {
            const symbol = document.getElementById('urlTestSymbol').value;
            const mapped = mapSymbolToTradingView(symbol);
            const url = `https://www.tradingview.com/chart/?symbol=${mapped}`;
            
            const result = document.getElementById('urlResult');
            result.innerHTML = `
                <strong>Generated URL:</strong><br>
                <a href="${url}" target="_blank">${url}</a>
            `;
            result.style.display = 'block';
        }
        
        function openTradingView() {
            const symbol = document.getElementById('urlTestSymbol').value;
            const mapped = mapSymbolToTradingView(symbol);
            const url = `https://www.tradingview.com/chart/?symbol=${mapped}`;
            
            window.open(url, '_blank');
            
            const result = document.getElementById('urlResult');
            result.innerHTML = `
                <strong>Opened TradingView for:</strong> ${symbol} (${mapped})<br>
                <em>Check if a new tab opened with the TradingView chart</em>
            `;
            result.style.display = 'block';
        }
    </script>
</body>
</html>